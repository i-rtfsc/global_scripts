# Neovim 新功能完全使用指南

> 🎯 **本文档专为新手设计**，每个功能都会详细说明每一步操作

## 📑 目录

- [浮动终端 (ToggleTerm)](#浮动终端-toggleterm)
- [多光标编辑](#多光标编辑-vim-visual-multi)
- [代码调试器 (DAP)](#代码调试器-dap)
- [快速文件切换 (Harpoon)](#快速文件切换-harpoon)
- [代码大纲视图 (Aerial)](#代码大纲视图-aerial)
- [撤销历史树 (Undotree)](#撤销历史树-undotree)
- [测试运行器 (Neotest)](#测试运行器-neotest)
- [Git 可视化工具 (Neogit)](#git-可视化工具-neogit)
- [代码重构工具](#代码重构工具-refactoring)
- [Markdown 预览](#markdown-预览)

---

## 浮动终端 (ToggleTerm)

### 什么是浮动终端？

浮动终端就是在 Neovim 里**弹出一个终端窗口**，可以随时打开/关闭，不需要退出 Neovim。

### 为什么比内置终端好？

1. **更美观** - 浮动在中间，有圆角边框
2. **更方便** - 一键打开/关闭（<kbd>Ctrl</kbd>+<kbd>\\</kbd>）
3. **更智能** - 记住你的工作目录和会话状态
4. **多种布局** - 支持浮动、水平、垂直分割

### 基础使用（必看！）

#### 1️⃣ 打开浮动终端

**场景**：你正在编辑代码，需要运行一个命令

```
操作步骤：
1. 确保你在【普通模式】（如果不确定，按 Esc 键）
2. 同时按下 Ctrl + \（反斜杠）
3. 终端窗口会从中间弹出 ✨
```

**实际按键**：<kbd>Ctrl</kbd>+<kbd>\\</kbd>

**效果**：屏幕中间弹出一个浮动的终端窗口

#### 2️⃣ 在终端里输入命令

```
操作步骤：
1. 终端打开后，你已经在【插入模式】，可以直接输入命令
2. 输入命令，比如：ls -la
3. 按 Enter 执行命令
```

**示例**：
```bash
# 直接输入这些命令
ls          # 查看当前目录文件
pwd         # 查看当前路径
python test.py   # 运行 Python 脚本
```

#### 3️⃣ 关闭浮动终端

**方法1（推荐）**：再次按 <kbd>Ctrl</kbd>+<kbd>\\</kbd>
```
操作步骤：
1. 在终端窗口中，再次按 Ctrl + \
2. 终端隐藏（但会话保留！）
```

**方法2**：先退出终端模式，再关闭
```
操作步骤：
1. 按 Esc 键（退出终端模式，进入普通模式）
2. 输入 :q 然后按 Enter
3. 终端关闭
```

#### 4️⃣ 重新打开终端（会话保留）

```
操作步骤：
1. 再次按 Ctrl + \
2. 之前的终端内容还在！历史命令也保留！
```

**💡 小贴士**：这就是浮动终端的强大之处 - 你可以随时隐藏/显示，不会丢失任何内容！

### 高级使用

#### 水平分割终端（底部终端）

**场景**：想要一个在底部的终端，像 VSCode 一样

```
操作步骤：
1. 确保在【普通模式】（按 Esc）
2. 按空格键（等待提示）
3. 按 t 键
4. 按 h 键
5. 终端出现在底部 📐
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>h</kbd>

**记忆方法**：
- `leader` (空格) + `t`(terminal) + `h`(horizontal 水平)

#### 垂直分割终端（侧边终端）

**场景**：想要一个在右侧的终端

```
操作步骤：
1. 确保在【普通模式】（按 Esc）
2. 按空格键
3. 按 t 键
4. 按 v 键
5. 终端出现在右侧 📏
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>v</kbd>

**记忆方法**：
- `leader` (空格) + `t`(terminal) + `v`(vertical 垂直)

#### 切换浮动终端（中间大窗口）

**场景**：想要回到浮动模式

```
操作步骤：
1. 确保在【普通模式】（按 Esc）
2. 按空格键
3. 按 t 键
4. 按 f 键
5. 终端变成浮动模式 🎈
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>f</kbd>

### 终端内的快捷键

#### 从终端模式返回普通模式

**问题**：我在终端里，想用 Vim 快捷键怎么办？

```
操作步骤：
1. 在终端中，按 Esc 键
2. 现在你回到了【普通模式】
3. 可以用 Vim 快捷键了（比如 :q 关闭）
```

**实际按键**：<kbd>Esc</kbd>

#### 在终端和编辑器之间切换窗口

**场景**：终端在左边，代码在右边，想切换

```
操作步骤（在终端中）：
1. 按 Esc 进入普通模式
2. 按 Ctrl + h（向左切换窗口）
3. 或 Ctrl + l（向右切换窗口）
4. 或 Ctrl + j（向下切换窗口）
5. 或 Ctrl + k（向上切换窗口）
```

**快捷键**：
- <kbd>Ctrl</kbd>+<kbd>h</kbd> - 切换到左边窗口
- <kbd>Ctrl</kbd>+<kbd>l</kbd> - 切换到右边窗口
- <kbd>Ctrl</kbd>+<kbd>j</kbd> - 切换到下面窗口
- <kbd>Ctrl</kbd>+<kbd>k</kbd> - 切换到上面窗口

### 实战示例

#### 示例1：运行 Python 脚本

```
完整步骤：
1. 正在编辑 test.py
2. 按 Ctrl + \ 打开终端
3. 输入：python test.py
4. 按 Enter 运行
5. 查看输出结果
6. 按 Ctrl + \ 隐藏终端
7. 继续编辑代码
8. 需要时再按 Ctrl + \ 打开（之前的输出还在！）
```

#### 示例2：使用 Git 提交代码

```
完整步骤：
1. 正在编辑代码
2. 按 空格 t h 打开底部终端（方便查看）
3. 输入：git status（查看修改）
4. 输入：git add .（添加文件）
5. 输入：git commit -m "update"（提交）
6. 按 Esc 退出终端模式
7. 输入 :q 关闭终端
```

#### 示例3：同时查看日志和编辑代码

```
完整步骤：
1. 打开代码文件
2. 按 空格 t v 打开右侧终端
3. 在终端输入：tail -f app.log（实时查看日志）
4. 按 Esc，然后 Ctrl + h 切换到左边的代码窗口
5. 编辑代码的同时，右边终端实时显示日志
6. 需要查看日志时，按 Ctrl + l 切到右边
```

### 常见问题

#### Q1: 按 Ctrl+\ 没反应？

**解决方法**：
1. 检查是否在**普通模式**（按 Esc 确保进入普通模式）
2. 确认是反斜杠 `\` 而不是正斜杠 `/`
3. 键盘布局是否正确（中文输入法切换到英文）

#### Q2: 终端打开了，但无法输入命令？

**原因**：你可能在普通模式

**解决方法**：
1. 按 `i` 进入插入模式
2. 或者按 `a` 进入插入模式
3. 现在可以输入命令了

#### Q3: 如何清除终端历史？

```
方法1：在终端中输入
clear

方法2：关闭并重新打开
1. 按 Esc
2. 输入 :q 关闭终端
3. 再按 Ctrl + \ 打开新终端
```

#### Q4: 终端字体太小/太大？

这个由你的终端模拟器控制，不是 Neovim 控制的。

在终端（不是 Neovim 内）调整字体：
- macOS Terminal: <kbd>Cmd</kbd>+<kbd>+</kbd> / <kbd>Cmd</kbd>+<kbd>-</kbd>
- iTerm2: <kbd>Cmd</kbd>+<kbd>+</kbd> / <kbd>Cmd</kbd>+<kbd>-</kbd>

#### Q5: 可以同时打开多个终端吗？

可以！每个终端都有编号：

```
打开多个终端：
1. 第一次按 Ctrl + \（终端1）
2. 关闭后，在命令模式输入 :2ToggleTerm（打开终端2）
3. 输入 :3ToggleTerm（打开终端3）

切换终端：
1. :1ToggleTerm（切换到终端1）
2. :2ToggleTerm（切换到终端2）
```

---

## 多光标编辑 (Vim Visual Multi)

### 什么是多光标？

多光标就是**同时在多个位置编辑文本**，就像 VSCode 里的多光标功能。

### 基础使用

#### 选择单词并批量修改

**场景**：你想把代码里所有的 `oldName` 改成 `newName`

```
完整步骤：
1. 将光标移到 oldName 上（用 hjkl 或鼠标）
2. 按 Ctrl + n（选中当前单词，高亮显示）
3. 再按 Ctrl + n（选中下一个 oldName）
4. 继续按 Ctrl + n（选中更多）
5. 按 c（删除选中的单词并进入插入模式）
6. 输入 newName
7. 按 Esc（所有选中的单词都改了！✨）
```

**实际按键**：
1. <kbd>Ctrl</kbd>+<kbd>n</kbd> （选择）
2. <kbd>Ctrl</kbd>+<kbd>n</kbd> （继续选择）
3. <kbd>c</kbd> （修改）
4. 输入新内容
5. <kbd>Esc</kbd> （完成）

#### 跳过某个匹配

**场景**：有个 `oldName` 不想修改

```
完整步骤：
1. 按 Ctrl + n 选中第一个
2. 按 Ctrl + n 选中第二个
3. 按 Ctrl + x（跳过第三个，不选中它）
4. 按 Ctrl + n 继续选中第四个
5. 按 c 修改，输入新内容
6. 按 Esc 完成（第三个没有被修改）
```

**快捷键**：<kbd>Ctrl</kbd>+<kbd>x</kbd> - 跳过当前匹配

#### 选择所有匹配

**场景**：想一次选中所有的 `oldName`

```
完整步骤：
1. 光标移到 oldName 上
2. 同时按 Ctrl + Alt + n（选中文件中所有 oldName）
3. 按 c 修改
4. 输入新内容
5. 按 Esc 完成
```

**快捷键**：<kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>n</kbd> - 选择全部

#### 垂直多光标（列编辑）

**场景**：想在多行的同一列位置插入内容

```
完整步骤：
1. 将光标移到第一行要插入的位置
2. 按 Ctrl + Down（向下添加光标）
3. 继续按 Ctrl + Down（再添加更多行）
4. 或者按 Ctrl + Up（向上添加光标）
5. 按 i 进入插入模式
6. 输入内容（所有行同时输入！）
7. 按 Esc 完成
```

**快捷键**：
- <kbd>Ctrl</kbd>+<kbd>↓</kbd> - 向下添加光标
- <kbd>Ctrl</kbd>+<kbd>↑</kbd> - 向上添加光标

### 实战示例

#### 示例1：批量添加引号

**任务**：把这些行：
```
apple
banana
orange
```

改成：
```
"apple"
"banana"
"orange"
```

**完整步骤**：
```
1. 光标移到第一行行首（按 0 键到行首）
2. 按 Ctrl + Down 两次（添加3个光标）
3. 按 i 进入插入模式
4. 输入 "
5. 按 Esc
6. 按 $ 跳到行尾
7. 按 a 进入行尾插入模式
8. 输入 "
9. 按 Esc 完成
```

#### 示例2：批量重命名变量

**任务**：把代码中的 `user_name` 改成 `username`

**完整步骤**：
```
代码：
let user_name = "Alice"
print(user_name)
user_name = "Bob"

步骤：
1. 光标移到第一个 user_name 上
2. 按 Ctrl + n（选中第一个）
3. 按 Ctrl + n（选中第二个）
4. 按 Ctrl + n（选中第三个）
5. 按 c（删除并进入插入模式）
6. 输入 username
7. 按 Esc（完成！所有 user_name 变成 username）
```

### 退出多光标模式

**问题**：不小心进入多光标模式，想退出

```
方法1：按 Esc 两次
方法2：按 Ctrl + c
```

---

## 代码调试器 (DAP)

### 什么是调试器？

调试器让你可以**暂停程序运行**，查看变量值，一步步执行代码，找出 bug。

### 首次使用：安装调试器

**必须先安装！** 否则无法调试

#### 方法1：使用 Mason（推荐）

```
完整步骤：
1. 打开 Neovim
2. 输入 :Mason（按 Enter）
3. 会打开一个窗口，列出所有可安装的工具
4. 按 / 进入搜索模式
5. 输入 debugpy（Python 调试器）
6. 按 Enter，光标会跳到 debugpy
7. 按 i（安装）
8. 等待安装完成（显示绿色勾号 ✓）
9. 按 q 退出 Mason
```

**其他语言的调试器**：
- Python: `debugpy`
- Rust/C/C++: `codelldb`
- Go: `delve`
- JavaScript/TypeScript: `node-debug2-adapter`

#### 方法2：使用命令直接安装

```
完整步骤：
1. 打开 Neovim
2. 输入 :DapInstall python（安装 Python 调试器）
3. 等待完成
```

### 基础使用

#### 1️⃣ 设置断点

**什么是断点？** 断点就是告诉程序"在这一行停下来"

```
完整步骤：
1. 打开你的 Python/Java/Go 等代码文件
2. 将光标移到你想暂停的那一行
3. 确保在【普通模式】（按 Esc）
4. 按空格键
5. 按 d 键
6. 按 b 键
7. 这一行前面出现一个 🔴 图标（断点已设置！）
```

**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>b</kbd>

**记忆方法**：`d`ebug + `b`reakpoint

#### 2️⃣ 开始调试

```
完整步骤：
1. 确保已设置断点（看到 🔴）
2. 按空格键
3. 按 d 键
4. 按 c 键
5. 程序开始运行，在断点处暂停 ▶️
6. 左边和底部会出现调试界面
```

**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>c</kbd>

**记忆方法**：`d`ebug + `c`ontinue

**调试界面说明**：
- **左边窗口**：
  - `scopes`: 显示当前变量的值
  - `breakpoints`: 显示所有断点
  - `stacks`: 显示调用栈
  - `watches`: 显示你要监视的变量
- **底部窗口**：
  - `repl`: 可以输入命令测试
  - `console`: 显示程序输出

#### 3️⃣ 单步执行

**场景**：程序在断点暂停了，想一行行看代码执行

**单步跳过（最常用）**：
```
操作：按空格 d o
效果：执行当前行，跳到下一行（不进入函数内部）
```
**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>o</kbd>（`o`ver - 跳过）

**单步进入**：
```
操作：按空格 d i
效果：如果当前行有函数调用，会进入函数内部
```
**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>i</kbd>（`i`nto - 进入）

**单步跳出**：
```
操作：按空格 d Shift+o（大写O）
效果：从当前函数跳出，回到调用处
```
**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>O</kbd>（`O`ut - 跳出）

#### 4️⃣ 查看变量值

**方法1：在左边的 scopes 窗口查看**
```
完整步骤：
1. 调试暂停后，左边显示 scopes 窗口
2. 按 Ctrl + h 切换到左边窗口（如果焦点不在左边）
3. 用 j k 键上下移动，查看不同变量
4. 变量的值会显示在右边
```

**方法2：用鼠标悬停**
```
完整步骤：
1. 调试暂停时
2. 将鼠标移到代码中的变量上
3. 会弹出显示变量的值（虚拟文本）
```

#### 5️⃣ 继续执行

**场景**：看完当前位置，想让程序继续运行到下一个断点

```
操作：按空格 d c
效果：程序继续运行，直到遇到下一个断点或结束
```

**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>c</kbd>

#### 6️⃣ 停止调试

```
操作：按空格 d t
效果：停止调试，关闭调试界面
```

**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>t</kbd>（`t`erminate - 终止）

#### 7️⃣ 删除断点

```
完整步骤：
1. 光标移到有 🔴 的那一行
2. 按空格 d b（和设置断点一样）
3. 断点消失
```

**说明**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>b</kbd> 是**切换断点**，再按一次就删除

### 实战示例：调试 Python 代码

**代码示例**（test.py）：
```python
def calculate_sum(a, b):
    result = a + b
    return result

x = 10
y = 20
total = calculate_sum(x, y)
print(f"Total: {total}")
```

**完整调试步骤**：

```
步骤1：设置断点
1. 打开 test.py
2. 光标移到第2行（result = a + b）
3. 按 空格 d b（设置断点，看到 🔴）

步骤2：开始调试
1. 按 空格 d c（开始调试）
2. 程序运行，在第2行暂停

步骤3：查看变量
1. 看左边的 scopes 窗口
2. 找到 "Locals" 部分
3. 看到 a = 10, b = 20

步骤4：单步执行
1. 按 空格 d o（执行当前行）
2. result 变量出现，值为 30

步骤5：继续执行
1. 按 空格 d c（继续运行到结束）
2. 底部 console 显示：Total: 30

步骤6：停止调试
1. 按 空格 d t（停止调试）
```

### 调试界面操作

#### 打开/关闭调试 UI

```
操作：按空格 d u
效果：显示或隐藏调试界面（scopes, breakpoints等窗口）
```

**快捷键**：<kbd>空格</kbd> <kbd>d</kbd> <kbd>u</kbd>（`u`i - 界面）

#### 在调试窗口之间切换

```
方法1：用鼠标点击不同窗口
方法2：用键盘
1. Ctrl + h（切到左边窗口）
2. Ctrl + l（切到右边代码窗口）
3. Ctrl + j（切到底部窗口）
4. Ctrl + k（切到上面窗口）
```

---

## 快速文件切换 (Harpoon)

### 什么是 Harpoon？

Harpoon 就像给文件**打上书签**，可以一键跳转，不用每次都搜索文件。

### 为什么需要 Harpoon？

**场景**：你经常在这4个文件之间切换：
- `main.py` - 主程序
- `utils.py` - 工具函数
- `config.py` - 配置文件
- `test.py` - 测试文件

用 Harpoon，你可以：
- 按 <kbd>空格</kbd> <kbd>h</kbd> <kbd>1</kbd> 跳到 main.py
- 按 <kbd>空格</kbd> <kbd>h</kbd> <kbd>2</kbd> 跳到 utils.py
- 瞬间切换，不用搜索！

### 基础使用

#### 1️⃣ 添加文件到 Harpoon

```
完整步骤：
1. 打开你常用的文件（比如 main.py）
2. 确保在【普通模式】（按 Esc）
3. 按空格键
4. 按 h 键
5. 按 a 键
6. 文件添加成功！（底部会有提示）
```

**快捷键**：<kbd>空格</kbd> <kbd>h</kbd> <kbd>a</kbd>

**记忆方法**：`h`arpoon + `a`dd

#### 2️⃣ 查看 Harpoon 列表

```
完整步骤：
1. 确保在【普通模式】
2. 按空格键
3. 按 h 键两次
4. 会弹出一个窗口，显示所有添加的文件
5. 用 j k 键上下移动
6. 按 Enter 打开文件
7. 按 q 关闭窗口
```

**快捷键**：<kbd>空格</kbd> <kbd>h</kbd> <kbd>h</kbd>

**记忆方法**：`h`arpoon + `h`arpoon (重复)

#### 3️⃣ 快速跳转到文件

**最强大的功能！**

```
完整步骤：
1. 你已经添加了4个文件到 Harpoon
2. 想跳到第1个文件，按 空格 h 1
3. 想跳到第2个文件，按 空格 h 2
4. 想跳到第3个文件，按 空格 h 3
5. 想跳到第4个文件，按 空格 h 4
```

**快捷键**：
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>1</kbd> - 跳到第1个文件
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>2</kbd> - 跳到第2个文件
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>3</kbd> - 跳到第3个文件
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>4</kbd> - 跳到第4个文件

#### 4️⃣ 在 Harpoon 文件之间循环切换

```
向下切换（下一个文件）：
1. 按空格 h n
2. 跳到下一个 Harpoon 文件

向上切换（上一个文件）：
1. 按空格 h p
2. 跳到上一个 Harpoon 文件
```

**快捷键**：
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>n</kbd> - `n`ext（下一个）
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>p</kbd> - `p`revious（上一个）

### 实战示例

#### 设置你的工作流

**场景**：开发一个 Web 项目

```
步骤1：添加常用文件到 Harpoon
1. 打开 src/main.js，按 空格 h a（添加）
2. 打开 src/api.js，按 空格 h a（添加）
3. 打开 src/utils.js，按 空格 h a（添加）
4. 打开 README.md，按 空格 h a（添加）

步骤2：快速切换
现在你可以：
- 按 空格 h 1 → 跳到 main.js
- 按 空格 h 2 → 跳到 api.js
- 按 空格 h 3 → 跳到 utils.js
- 按 空格 h 4 → 跳到 README.md

步骤3：边写代码边快速跳转
1. 正在编辑 main.js
2. 需要改 utils.js，按 空格 h 3（瞬间跳转！）
3. 改完 utils 函数
4. 按 空格 h 1（立即回到 main.js）
5. 不需要搜索，不需要记住路径！✨
```

### 管理 Harpoon 列表

#### 删除文件

```
完整步骤：
1. 按 空格 h h（打开 Harpoon 列表）
2. 用 j k 键移动到要删除的文件
3. 按 d 键（删除这个文件）
4. 按 q 关闭窗口
```

#### 调整文件顺序

```
完整步骤：
1. 按 空格 h h（打开列表）
2. 想把第3个文件变成第1个？
3. 用 j k 移动到第3个文件
4. 按 dd 剪切这一行
5. 用 k 移到第一行
6. 按 P（大写）粘贴到上面
7. 按 :w 保存
8. 按 q 退出
```

---

## 代码大纲视图 (Aerial)

### 什么是代码大纲？

代码大纲显示文件的**结构**：所有的类、函数、方法，就像目录一样。

### 打开代码大纲

```
完整步骤：
1. 打开一个代码文件（Python/Java/JavaScript等）
2. 确保在【普通模式】（按 Esc）
3. 按空格键
4. 按 a 键
5. 按 o 键
6. 右边会出现代码大纲窗口 📑
```

**快捷键**：<kbd>空格</kbd> <kbd>a</kbd> <kbd>o</kbd>

**记忆方法**：`a`erial + `o`pen

### 使用代码大纲

#### 跳转到函数/类

```
完整步骤：
1. 代码大纲已打开（右边窗口）
2. 按 Ctrl + l（切换到大纲窗口）
3. 用 j k 键上下选择函数/类
4. 按 Enter（跳转到这个函数）
5. 左边的代码自动跳到对应位置！
```

#### 展开/折叠

```
展开：按 o 键（如果函数有子项）
折叠：按 h 键
展开所有：按 zR
折叠所有：按 zM
```

#### 关闭代码大纲

```
方法1：再次按 空格 a o
方法2：在大纲窗口按 q
```

### 快速跳转到下一个/上一个函数

**不需要打开大纲窗口！**

```
跳到下一个函数：
1. 确保在代码窗口
2. 按 } 键（右花括号）
3. 光标跳到下一个函数

跳到上一个函数：
1. 按 { 键（左花括号）
2. 光标跳到上一个函数
```

**快捷键**：
- <kbd>{</kbd> - 上一个函数
- <kbd>}</kbd> - 下一个函数

---

## 撤销历史树 (Undotree)

### 什么是撤销树？

撤销树让你看到**所有的编辑历史**，可以回到任何一个时间点，就像时间机器！

### 打开撤销树

```
完整步骤：
1. 确保在【普通模式】（按 Esc）
2. 按空格键
3. 按 u 键
4. 左边会出现撤销树窗口 🌳
```

**快捷键**：<kbd>空格</kbd> <kbd>u</kbd>

### 使用撤销树

```
完整步骤：
1. 撤销树已打开
2. 用 j k 键上下移动，选择不同的历史状态
3. 右边的代码实时显示那个时间点的内容
4. 按 Enter 恢复到选中的状态
5. 按 q 关闭撤销树
```

### 实战示例

**场景**：你改了很多代码，想回到1小时前

```
完整步骤：
1. 按 空格 u（打开撤销树）
2. 看到树形结构，每个节点是一次修改
3. 用 j 键往下翻，找到标记为 "1h ago" 的节点
4. 按 Enter（代码恢复到1小时前！）
5. 如果不满意，再选其他节点
6. 满意后按 q 关闭
```

---

## 测试运行器 (Neotest)

### 运行单个测试

```
完整步骤：
1. 打开测试文件（比如 test_main.py）
2. 光标移到某个测试函数上（比如 test_login）
3. 按空格 t t
4. 这个测试开始运行
5. 底部显示测试结果（✓ 通过 或 ✗ 失败）
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>t</kbd>

### 运行整个文件的测试

```
完整步骤：
1. 打开测试文件
2. 按空格 t Shift+t（大写T）
3. 文件中所有测试运行
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>T</kbd>

### 查看测试摘要

```
完整步骤：
1. 按空格 t s
2. 左边出现测试摘要窗口
3. 显示所有测试，用不同颜色标记：
   - ✓ 绿色：通过
   - ✗ 红色：失败
   - 黄色：正在运行
```

**快捷键**：<kbd>空格</kbd> <kbd>t</kbd> <kbd>s</kbd>

---

## Git 可视化工具 (Neogit)

### 打开 Neogit

```
完整步骤：
1. 确保在【普通模式】（按 Esc）
2. 按空格 g g
3. 会打开 Neogit 界面，显示 Git 状态
```

**快捷键**：<kbd>空格</kbd> <kbd>g</kbd> <kbd>g</kbd>

### Neogit 界面说明

```
界面分为几个部分：
1. Untracked files（未跟踪的文件）- 新文件
2. Unstaged changes（未暂存的修改）- 修改但未 add
3. Staged changes（已暂存的修改）- 已 add，待 commit

用 j k 键在文件间移动
```

### 基本 Git 操作

#### Stage 文件（git add）

```
完整步骤：
1. 在 Neogit 界面，用 j k 移到要添加的文件
2. 按 s 键（stage）
3. 文件从 "Unstaged" 移到 "Staged"
```

**快捷键**：<kbd>s</kbd> - stage

#### Unstage 文件（撤销 add）

```
完整步骤：
1. 移到 Staged 区域的文件
2. 按 u 键（unstage）
3. 文件回到 Unstaged
```

**快捷键**：<kbd>u</kbd> - unstage

#### Commit 提交

```
完整步骤：
1. 确保文件已在 Staged 区域
2. 按 c 键，然后再按 c 键（commit commit）
3. 会打开编辑器，输入提交信息
4. 按 i 进入插入模式
5. 输入提交信息（比如 "fix: bug修复"）
6. 按 Esc，然后 :wq 保存退出
7. 提交完成！
```

**快捷键**：<kbd>c</kbd> <kbd>c</kbd>

#### Push 推送

```
完整步骤：
1. 在 Neogit 界面
2. 按 P（大写）然后按 p（小写）
3. 代码推送到远程仓库
```

**快捷键**：<kbd>P</kbd> <kbd>p</kbd>

### 查看文件差异

#### 打开 Diffview

```
完整步骤：
1. 按空格 g d o
2. 打开 Diffview，显示所有修改
3. 左边是文件列表，右边是差异对比
4. 用 j k 选择文件
5. 按 Enter 查看这个文件的修改
```

**快捷键**：<kbd>空格</kbd> <kbd>g</kbd> <kbd>d</kbd> <kbd>o</kbd>

#### 查看文件历史

```
完整步骤：
1. 打开某个文件
2. 按空格 g d f
3. 显示这个文件的所有提交历史
4. 用 j k 选择提交
5. 按 Enter 查看那次提交的修改
```

**快捷键**：<kbd>空格</kbd> <kbd>g</kbd> <kbd>d</kbd> <kbd>f</kbd>

---

## 代码重构工具 (Refactoring)

### 提取函数

**场景**：一段代码太长，想提取成函数

```
完整步骤：
1. 用鼠标或 v 键进入可视模式
2. 选中要提取的代码（用 j k 选择多行）
3. 按空格 r e
4. 输入新函数的名字
5. 按 Enter
6. 代码自动变成函数调用，函数定义添加到上面！
```

**快捷键**：<kbd>空格</kbd> <kbd>r</kbd> <kbd>e</kbd>（`e`xtract）

### 提取变量

**场景**：复杂的表达式想提取成变量

```
完整步骤：
1. 选中表达式（可视模式）
2. 按空格 r v
3. 输入变量名
4. 按 Enter
5. 表达式变成变量，变量定义添加到上面
```

**快捷键**：<kbd>空格</kbd> <kbd>r</kbd> <kbd>v</kbd>（`v`ariable）

---

## Markdown 预览

### 首次使用：安装依赖

```
完整步骤：
1. 打开 Neovim
2. 输入 :call mkdp#util#install()
3. 按 Enter
4. 等待安装完成（需要 npm）
```

### 预览 Markdown

```
完整步骤：
1. 打开 .md 文件（比如 README.md）
2. 确保在【普通模式】
3. 按空格 m p
4. 浏览器自动打开，显示预览
5. 编辑 Markdown，浏览器自动更新
```

**快捷键**：<kbd>空格</kbd> <kbd>m</kbd> <kbd>p</kbd>

### 关闭预览

```
操作：再次按 空格 m p
或：按 空格 m Shift+s（大写S）
```

---

## 💡 学习建议

### 新手建议学习顺序

**第1天：掌握基础**
1. ✅ 浮动终端（最常用！）
2. ✅ 多光标编辑
3. ✅ 查看代码大纲

**第2天：文件管理**
1. ✅ Harpoon 快速切换
2. ✅ Git 可视化操作

**第3天：高级功能**
1. ✅ 调试器（重要！）
2. ✅ 测试运行器
3. ✅ 代码重构

### 常用快捷键速查表

| 功能 | 快捷键 | 说明 |
|------|--------|------|
| 浮动终端 | <kbd>Ctrl</kbd>+<kbd>\\</kbd> | 最常用！ |
| 多光标 | <kbd>Ctrl</kbd>+<kbd>n</kbd> | VSCode 风格 |
| 断点 | <kbd>空格</kbd> <kbd>d</kbd> <kbd>b</kbd> | 调试必备 |
| 开始调试 | <kbd>空格</kbd> <kbd>d</kbd> <kbd>c</kbd> | 运行程序 |
| Harpoon | <kbd>空格</kbd> <kbd>h</kbd> <kbd>a</kbd> | 添加文件 |
| 跳转文件 | <kbd>空格</kbd> <kbd>h</kbd> <kbd>1-4</kbd> | 瞬间跳转 |
| 代码大纲 | <kbd>空格</kbd> <kbd>a</kbd> <kbd>o</kbd> | 查看结构 |
| Git 界面 | <kbd>空格</kbd> <kbd>g</kbd> <kbd>g</kbd> | 可视化 |
| 撤销树 | <kbd>空格</kbd> <kbd>u</kbd> | 时间旅行 |

### 记忆技巧

所有快捷键都遵循：**空格键 + 功能首字母 + 操作首字母**

例如：
- <kbd>空格</kbd> <kbd>d</kbd> <kbd>b</kbd> = `d`ebug + `b`reakpoint
- <kbd>空格</kbd> <kbd>h</kbd> <kbd>a</kbd> = `h`arpoon + `a`dd
- <kbd>空格</kbd> <kbd>g</kbd> <kbd>g</kbd> = `g`it + `g`it (Neogit)
- <kbd>空格</kbd> <kbd>t</kbd> <kbd>h</kbd> = `t`erminal + `h`orizontal

### 遇到问题？

1. 按 <kbd>空格</kbd> <kbd>f</kbd> <kbd>k</kbd> 搜索所有快捷键
2. 查看 `:help <plugin-name>`
3. 参考 [操作指南](nvim-operations.md)
4. 参考 [快捷键完整参考](nvim-keymaps.md)

---

**祝你使用愉快！🎉**

记住：一次学一个功能，先用熟练，再学下一个！
